/*!
 * artDialog iframeTools
 * Date: 2011-12-08 1:32
 * http://code.google.com/p/artdialog/
 * (c) 2009-2011 TangBin, http://www.planeArt.cn
 *
 * This is licensed under the GNU LGPL, version 2.1 or later.
 * For details, see: http://creativecommons.org/licenses/LGPL/2.1/
 */
(function(j,e,c,s){var o,l,m,p=e.name=e.name||"@ARTDIALOG.WINNAME"+ +new Date,u=e.VBArray&&!e.XMLHttpRequest;j(function(){!e.jQuery&&"BackCompat"===document.compatMode&&alert('artDialog Error: document.compatMode === "BackCompat"')});var k=c.top=function(){var a=e,b=function(a){try{var b=e[a].document}catch(c){return!1}return e[a].artDialog&&0===b.getElementsByTagName("frameset").length};if(b("top"))a=e.top;else if(b("parent"))a=e.parent;return a}();c.parent=k;o=k.artDialog;m=function(){return o.defaults.zIndex};
c.data=function(a,b){var d=c.top,f=d["@ARTDIALOG.DATA"]||{};d["@ARTDIALOG.DATA"]=f;if(b!==s)f[a]=b;else return f[a];return f};c.removeData=function(a){var b=c.top["@ARTDIALOG.DATA"];b&&b[a]&&delete b[a]};c.through=l=function(){var a=o.apply(this,arguments);k!==e&&(c.list[a.config.id]=a);return a};k!==e&&j(e).bind("unload",function(){var a=c.list,b,d;for(d in a)if(a[d]){if(b=a[d].config)b.duration=0;a[d].close()}});c.open=function(a,b,d){var b=b||{},f,i,h,g,r,k,n,o,q=c.top;if(!1===d)var d=+new Date,
p=a.replace(/([?&])_=[^&]*/,"$1_="+d),a=p+(p===a?(/\?/.test(a)?"&":"?")+"_="+d:"");var v=function(){var a,c;a=i.content.find(".aui_loading");var d=f.config;h.addClass("aui_state_full");a&&a.hide();try{n=g.contentWindow,k=j(n.document),o=n.document.body}catch(e){g.style.cssText="width:100%;height:100%;border:none 0";d.follow?f.follow(d.follow):f.position(d.left,d.top);b.init&&b.init.call(f,n,q);b.init=null;return}a="auto"===d.width?k.width()+(u?0:parseInt(j(o).css("marginLeft"))):d.width;c="auto"===
d.height?k.height():d.height;setTimeout(function(){g.style.cssText="width:100%;height:100%;border:none 0"},0);f.size(a,c);d.follow?f.follow(d.follow):f.position(d.left,d.top);b.init&&b.init.call(f,n,q);b.init=null},d={zIndex:m(),init:function(){f=this;i=f.DOM;h=i.content;g=f.iframe=q.document.createElement("iframe");g.src=a;g.name="Open"+f.config.id;g.style.cssText="position:absolute;left:-9999em;top:-9999em;border:none 0;background:transparent";g.setAttribute("frameborder",0,0);g.setAttribute("allowTransparency",
!0);r=j(g);f.content().appendChild(g);n=g.contentWindow;try{n.name=g.name,c.data(g.name+"@ARTDIALOG.OPEN",f),c.data(g.name+"@ARTDIALOG.OPENER",e)}catch(b){}r.bind("load",v)},close:function(){r.css("display","none").unbind("load",v);if(b.close&&!1===b.close.call(this,g.contentWindow,q))return!1;h.removeClass("aui_state_full");r[0].src="about:blank";r.remove();try{c.removeData(g.name+"@ARTDIALOG.OPEN"),c.removeData(g.name+"@ARTDIALOG.OPENER")}catch(a){}}};if("function"===typeof b.ok)d.ok=function(){return b.ok.call(f,
g.contentWindow,q)};if("function"===typeof b.cancel)d.cancel=function(){return b.cancel.call(f,g.contentWindow,q)};delete b.content;for(var t in b)d[t]===s&&(d[t]=b[t]);return l(d)};c.open.api=c.data(p+"@ARTDIALOG.OPEN");c.opener=c.data(p+"@ARTDIALOG.OPENER")||e;c.open.origin=c.opener;c.close=function(){var a=c.data(p+"@ARTDIALOG.OPEN");a&&a.close();return!1};k!=e&&j(document).bind("mousedown",function(){var a=c.open.api;a&&a.zIndex()});c.load=function(a,b,d){var d=d||!1,c=b||{},e={zIndex:m(),init:function(b){var e=
this;j.ajax({url:a,success:function(a){e.content(a);c.init&&c.init.call(e,b)},cache:d})}};delete b.content;for(var h in c)e[h]===s&&(e[h]=c[h]);return l(e)};c.alert=function(a,b){return l({id:"Alert",zIndex:m(),icon:"warning",fixed:!0,lock:!0,content:a,ok:!0,close:b})};c.confirm=function(a,b,d){return l({id:"Confirm",zIndex:m(),icon:"question",fixed:!0,lock:!0,opacity:0.1,content:a,ok:function(a){return b.call(this,a)},cancel:function(a){return d&&d.call(this,a)}})};c.prompt=function(a,b,d){var d=
d||"",c;return l({id:"Prompt",zIndex:m(),icon:"question",fixed:!0,lock:!0,opacity:0.1,content:['<div style="margin-bottom:5px;font-size:12px">',a,'</div><div><input value="',d,'" style="width:18em;padding:6px 4px" /></div>'].join(""),init:function(){c=this.DOM.content.find("input")[0];c.select();c.focus()},ok:function(a){return b&&b.call(this,c.value,a)},cancel:!0})};c.ajaxBefore=function(a){return l({id:"ajaxLoad",zIndex:m(),title:"",cancel:!1,fixed:!0,lock:!0,content:'<div style=" height:25px;display: block;"></div><div style=" width: 200px; height: 65px;"> <span style="  height: 30px; left: 80px; position: absolute; top: 95px; width: 200px; padding:10px;">'+
a+'</span><img src="images/load.gif" style=" width: 32px; height: 32px;border: none; float:left; " /></div>'})};c.tips=function(a,b){return l({id:"Tips",zIndex:m(),title:!1,cancel:!1,fixed:!0,lock:!1}).content('<div style="padding: 0 1em;">'+a+"</div>").time(b||1.5)};j(function(){var a=c.dragEvent;if(a){var b=j(e),d=j(document),f=u?"absolute":"fixed",i=a.prototype,a=document.createElement("div"),h=a.style;h.cssText="display:none;position:"+f+";left:0;top:0;width:100%;height:100%;cursor:move;filter:alpha(opacity=0);opacity:0;background:#FFF";
document.body.appendChild(a);i._start=i.start;i._end=i.end;i.start=function(){var a=c.focus.DOM,e=a.main[0],a=a.content[0].getElementsByTagName("iframe")[0];i._start.apply(this,arguments);h.display="block";h.zIndex=c.defaults.zIndex+3;if("absolute"===f)h.width=b.width()+"px",h.height=b.height()+"px",h.left=d.scrollLeft()+"px",h.top=d.scrollTop()+"px";if(a&&307200<e.offsetWidth*e.offsetHeight)e.style.visibility="hidden"};i.end=function(){var a=c.focus;i._end.apply(this,arguments);h.display="none";
if(a)a.DOM.main[0].style.visibility="visible"}}})})(this.art||this.jQuery,this,this.artDialog);